---
title: "Final Project: Music vs Mental Health Analysis"
author: "Calvin, Vy, Karen"
date: "December 2, 2023"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```


# Executive Summary

We aim to explore how music impact mental health by analyzing relevant data. This will help us determine how music is the most beneficial for mental health. We'll compare this to the amount of people suffering from certain mental conditions.

# Importing the dataset

```{r, echo = False}
data <- read.csv('mxmh_survey_results.csv')
head(data)
```
```{r, echo = False}
require('tidyr')
require('dplyr')
require('ggplot2')
```
# Making categories for Anxious, Depressed, and Insomniac

```{r, echo = False}
# mark people as anxious (1) if anxiety > 5, not anxious (0) otherwise
data$Anxious = ifelse(data$Anxiety > 5, 1, 0)
# mark people as anxious (1) if anxiety > 5, not anxious (0) otherwise
data$Depressed = ifelse(data$Depression > 5, 1, 0)
# mark people as anxious (1) if anxiety > 5, not anxious (0) otherwise
data$Insomniac = ifelse(data$Insomnia > 5, 1, 0)

head(data)
attach(data)
```

# Testing Non-linearity

We don't need to test for non-linearity for categorical variables so we will only test for non-linearity on the continuous variables, namely age.
```{r}
ggplot(pivot_longer(data = data, 2), aes(Hours.per.day, Age)) + 
  theme_minimal() + geom_point() +
  labs(title = "Non-linearity For Categorical Variables") +
  labs(x = "Hours Per Day", y = " Age")

```

Plotting the covariate age against hours per day, it doesn't seem that there is a linear relationship between the 2.
To try to fix this, let's take the log of age.
With log age:
```{r}
ggplot(pivot_longer(data = data, 2), aes(Hours.per.day, log(Age))) + 
    theme_minimal() + geom_point() + facet_wrap('name', scales = 'free')
```
# Fitted model
```{r, echo = FALSE}
fitA <- lm(Hours.per.day ~ Age + Anxious + Depressed + Insomniac + Music.effects)
summary(fitA)


par(mfrow = c(2,2))
plot(fitA)


```
FitA is not normal as shown in the Q-Q Plot where the error points are rising off the normal line which show a right skew. Additionally, FitA does have a constant variance which was evident in Residual VS Fitted plot where there is no clear pattern however, there appear to be many outliers.


```{r,echo = FALSE}
fitB <- lm(Hours.per.day ~ Depressed + Insomniac)
summary(fitB)

par(mfrow = c(2,2))
plot(fitB)


```
FitB is not normal as shown in the Q-Q Plot where the error points are rising off the normal line which show a right skew. Additionally, FitB does have a constant variance which was evident in Residual VS Fitted plot where there is no clear pattern however, there appear to be many outliers.


```{r,echo = FALSE}
fitC <- lm(Hours.per.day ~ Age + Anxious )
summary(fitC)


par(mfrow = c(2,2))
plot(fitC)
```
FitC is not normal as shown in the Q-Q Plot where the error points are rising off the normal line which show a right skew. Additionally, FitC does have a constant variance which was evident in Residual VS Fitted plot where there is no clear pattern however, there appear to be many outliers.The outliers can be clearly seen in Residuals vs Leverage plot where point 696 is outside of the Cookline.

```{r,echo = FALSE}

fitD <- lm(Hours.per.day ~ Anxious + Depressed + Insomniac)
summary(fitD)

par(mfrow = c(2,2))
plot(fitD)
```
FitC is not normal as shown in the Q-Q Plot where the error points are rising off the normal line which show a right skew. Additionally, FitC does have a constant variance which was evident in Residual VS Fitted plot where there is no clear pattern however, there appear to be possible outliers.


```{r,echo = FALSE}
fitE <- lm(Hours.per.day ~ -1 + Age + Anxious + Depressed + Insomniac + Music.effects)
summary(fitE)

par(mfrow = c(2,2))
plot(fitE)
```
```{r}
anova_result <- anova(fitA, fitE, test = "LRT")
anova_result
```


# AIC
```{r}
# Add  labels
AIC(fitA)
AIC(fitB)
AIC(fitC)
AIC(fitD)
AIC(fitE)
```
# BIC
```{r}
BIC(fitA)
BIC(fitB)
BIC(fitC)
BIC(fitD)
BIC(fitE)
```
- fitB has the best fit according to AIC and BIC because it has the lowest AIC and BIC.
- For the AIC, fitA, fitB, and fitE have very similar AICs but, as noted, fitB has the lowest.



# Analysis and Conclusion




\newpage
# Code Appendix:

```{r ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}

```












