---
title: "Project Try 2"
author: "Karen Nguyen"
date: "2023-12-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Importing the dataset

```{r}
data <- read.csv('C:/Users/karen/Documents/STA141A/mxmh_survey_results.csv')
attach(data)
head(data)
```

# Libraries

```{r}
require('tidyr')
require('dplyr')
require('ggplot2')
```

# Making categories for Anxious, Depressed, and Insomniac
```{r}
# mark people as anxious (1) if anxiety > 5, not anxious (0) otherwise
data$Anxious = ifelse(Anxiety > 5, 1, 0)
# mark people as anxious (1) if anxiety > 5, not anxious (0) otherwise
data$Depressed = ifelse(Depression > 5, 1, 0)
# mark people as anxious (1) if anxiety > 5, not anxious (0) otherwise
data$Insomniac = ifelse(Insomnia > 5, 1, 0)

head(data)
attach(data)
```
# Testing Non-linearity

We don't need to test for non-linearity for categorical variables so we will only test for non-linearity on the continuous variables, namely age.
```{r}
ggplot(pivot_longer(data = data, 2), aes(Hours.per.day, Age)) + 
    theme_minimal() + geom_point() + facet_wrap('name', scales = 'free')
```
Plotting the covariate age against hours per day, it doesn't seem that there is a linear relationship between the 2.
To try to fix this, let's take the log of age.
With log age:
```{r}
ggplot(pivot_longer(data = data, 2), aes(Hours.per.day, log(Age))) + 
    theme_minimal() + geom_point() + facet_wrap('name', scales = 'free')
```

# Fitted models
```{r}
fitA <- lm(Hours.per.day ~ Age + Anxious + Depressed + Insomniac + Music.effects)
summary(fitA)
```
```{r}
fitB <- lm(Hours.per.day ~ Depressed + Insomniac)
summary(fitB)
```

```{r}
fitC <- lm(Hours.per.day ~ Age + Anxious)
summary(fitC)
```

```{r}
fitD <- lm(Hours.per.day ~ Anxious + Depressed + Insomniac)
summary(fitD)
```

```{r}
#fitA without intercept
fitE <- lm(Hours.per.day ~ -1 + Age + Anxious + Depressed + Insomniac + Music.effects)
summary(fitE)
```

# ANOVA test
```{r}
anova(fitA, fitE)
```
# AIC
```{r}
AIC(fitA)
AIC(fitB)
AIC(fitC)
AIC(fitD)
AIC(fitE)
```
# BIC
```{r}
BIC(fitA)
BIC(fitB)
BIC(fitC)
BIC(fitD)
BIC(fitE)
```
fitB has the best fit according to AIC and BIC because it has the lowest AIC and BIC.
(might be important?)
For the AIC, fitA, fitB, and fitE have very similar AICs but, as noted, fitB has the lowest.

